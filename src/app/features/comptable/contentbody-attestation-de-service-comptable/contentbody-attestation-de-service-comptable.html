<section class="content-area">
  <!-- Barre de filtre -->
  <div class="filter-bar">
    <!-- <div class="filter-group">
        <label>Statut :</label>
        <div class="filter-select" (click)="toggleStatusDropdown()">
          <span>{{ selectedStatus }}</span>
        </div>
        <ul class="dropdown-list" *ngIf="statusDropdownOpen">
          <li *ngFor="let s of ['Tous', 'Validé', 'En attente', 'Rejeté']"
              (click)="setStatus(s)"
              [class.active]="selectedStatus === s">
            {{ s }}
          </li>
        </ul>
    </div> -->

    <button class="export-btn">
      <img src="assets/87_477.svg" alt="Export Icon">
      <span>Exporter</span>
    </button>
  </div>

  <div class="data-card">
    <!-- Tableau 2 : Attestation de Service Fait -->
    <div class="table-section">
    
      <!-- États de chargement et d'erreur -->
      <div *ngIf="isLoading" class="loading-state">
        <p>Chargement des attestations...</p>
      </div>
      
      <div *ngIf="errorMessage && !isLoading" class="error-state">
        <p>{{ errorMessage }}</p>
      </div>
      
      <div *ngIf="!isLoading && !errorMessage" class="data-table">
        <div class="table-header">
          <div class="col col-1">Code</div>
          <div class="col col-2">Réf. Bon de Commande</div>
          <div class="col col-3">Fournisseur</div>
          <div class="col col-4">Titre</div>
          <div class="col col-5">Date Livraison</div>
          <div class="col col-6">Actions</div>
        </div>

        <!-- Exemple de ligne -->
        <div class="table-row" *ngFor="let attestation of filteredAttestations">
          <div class="col col-1">{{ attestation.code }}</div>
          <div class="col col-2">{{ attestation.referenceBonCommande }}</div>
          <div class="col col-3">{{ attestation.fournisseur }}</div>
          <div class="col col-4">{{ attestation.titre }}</div>
          <div class="col col-5">{{ attestation.dateLivraison | date:'dd/MM/yyyy' }}</div>
          
          <div class="col col-6 action-icons">
            <button class="action-btn" (click)="openDetailModal(attestation)"><img src="assets/87_501.svg" alt="details" /></button>
          </div>
        </div>
        
        <!-- Message si aucune attestation -->
        <div *ngIf="filteredAttestations.length === 0" class="empty-state">
          <p>Aucune attestation de service fait trouvée</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Modal de détails -->
<div class="modal-overlay" *ngIf="showDetailModal" (click)="closeDetailModal()">
  <div class="modal-content detail-modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header detail-header">
      <h2 class="modal-title">Détails de l'Attestation de Service Fait</h2>
      <button class="close-btn" (click)="closeDetailModal()">
        <img src="assets/mdi_cancel-bold.svg" alt="Fermer" class="close-icon">
      </button>
    </div>

    <div class="detail-body" *ngIf="selectedAttestation">
      <div class="detail-section full-width-fields">
        <div class="detail-group">
          <label>Code</label>
          <p class="detail-value">{{ selectedAttestation.code }}</p>
        </div>
        <div class="detail-group">
          <label>Référence Bon de Commande</label>
          <p class="detail-value">{{ selectedAttestation.referenceBonCommande }}</p>
        </div>
        <div class="detail-group">
          <label>Fournisseur</label>
          <p class="detail-value">{{ selectedAttestation.fournisseur }}</p>
        </div>
        <div class="detail-group">
          <label>Titre</label>
          <p class="detail-value">{{ selectedAttestation.titre }}</p>
        </div>
      </div>

      <div class="detail-section grid-fields">
        <div class="detail-group">
          <label>Date de Création</label>
          <p class="detail-value">{{ selectedAttestation.dateCreation }}</p>
        </div>
        <div class="detail-group">
          <label>Date de Livraison</label>
          <p class="detail-value">{{ selectedAttestation.dateLivraison }}</p>
        </div>
      </div>

      <div class="detail-section full-width-fields">
        <div class="detail-group">
          <label>Constat</label>
          <p class="detail-value description">{{ selectedAttestation.constat }}</p>
        </div>
        <div class="detail-group">
          <label>Preuve (Fichier joint)</label>
          <p class="detail-value">{{ selectedAttestation.preuve }}</p>
        </div>
      </div>
    </div>
  </div>
</div>